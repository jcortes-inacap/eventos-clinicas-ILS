---
import AdminLayout from '../../layouts/admin/admin-layout.astro'
import PageHeader from '../../components/common/page-header.astro'
import type { Props as PageHeaderProps } from '../../components/common/page-header.astro'
import { getAssetPrefix, getPathPrefix } from '../../../utils/path.js'

const securitySettingsConfig: PageHeaderProps = {
  title: 'Security Settings',
  breadcrumbs: [
    { label: 'Dashboard', href: getPathPrefix('/dashboard'), class: '' },
    { label: 'Users', href: getPathPrefix('/users'), class: '' },
    { label: 'Security', class: 'active' }
  ]
}
---

<AdminLayout
  title="Account Security"
  description="Manage your account security and authentication settings"
  currentPath="users/security"
>
  <PageHeader {...securitySettingsConfig} />
  <div class="row g-4">
    <!-- User Profile Sidebar -->
    <div class="col-lg-3">
      <div class="card p-3">
        <div class="card-header text-center pt-3">
          <div class="position-relative d-inline-block mb-4">
            <img
              src={getAssetPrefix('/assets/img/avatars/avatar2.jpg')}
              alt="User Avatar"
              class="rounded-circle"
              width="120"
              height="120"
              style="object-fit: cover;"
            />
            <button
              class="btn btn-primary btn-icon-sm position-absolute bottom-0 end-0 rounded-circle p-2"
              title="Change Profile Picture"
            >
              <i class="ri-camera-line"></i>
            </button>
          </div>
          <h5 class="mb-1">Amara Evans</h5>
          <p class="text-muted mb-0">
            <i class="ri-mail-line me-1"></i>amara@example.com
          </p>
        </div>
        <div class="card-body">
          <!-- Navigation Menu -->
          <nav class="nav-tree">
            <ul class="list-unstyled">
              <li class="nav-section">
                <span class="nav-section-text text-uppercase px-2">Personal</span>
              </li>
              <!-- Profile -->
              <li class="nav-item">
                <a class="nav-link" href={getPathPrefix('/users/profile')}>
                  <i class="ri-user-line"></i>
                  <span>Profile</span>
                </a>
              </li>
              <!-- Notifications -->
              <li class="nav-item">
                <a class="nav-link" href={getPathPrefix('/users/notifications')}>
                  <i class="ri-notification-4-line"></i>
                  <span>Notifications</span>
                </a>
              </li>
              <!-- Security -->
              <li class="nav-item active">
                <a class="nav-link" href={getPathPrefix('/users/security')}>
                  <i class="ri-shield-check-line"></i>
                  <span>Security</span>
                </a>
              </li>
              <li class="nav-section">
                <span class="nav-section-text text-uppercase px-2">Other</span>
              </li>
              <!-- Billing -->
              <li class="nav-item">
                <a class="nav-link" href={getPathPrefix('/users/billing')}>
                  <i class="ri-bank-card-line"></i>
                  <span>Billing</span>
                </a>
              </li>
              <!-- Team -->
              <li class="nav-item">
                <a class="nav-link" href={getPathPrefix('/users/team')}>
                  <i class="ri-group-line"></i>
                  <span>Team</span>
                </a>
              </li>
            </ul>
          </nav>
        </div>
      </div>
    </div>

    <!-- Security Settings -->
    <div class="col-lg-9">
      <!-- Password Management -->
      <div class="card">
        <div class="card-header bg-transparent">
          <div class="d-flex align-items-center">
            <i class="ri-lock-password-line me-2"></i>
            <h5 class="card-title mb-0">Password Management</h5>
          </div>
        </div>
        <div class="card-body">
          <form id="passwordUpdateForm">
            <div class="row g-3">
              <!-- Current Password -->
              <div class="col-12">
                <label class="form-label required">Current Password</label>
                <div class="password-wrapper">
                  <input
                    type="password"
                    class="form-control password-input"
                    id="currentPassword"
                    placeholder="Password"
                    autocomplete="current-password"
                    required
                  />
                  <button class="password-toggle" type="button" title="Toggle password visibility">
                    <i class="ri-eye-off-line"></i>
                  </button>
                </div>
              </div>
              <!-- New Password -->
              <div class="col-12">
                <label class="form-label required">New Password</label>
                <div class="d-flex align-items-center gap-2">
                  <div class="password-wrapper w-100">
                    <input
                      type="password"
                      class="form-control password-input"
                      id="newPassword"
                      placeholder="Password"
                      autocomplete="new-password"
                      required
                    />
                    <button
                      class="password-toggle"
                      type="button"
                      title="Toggle password visibility"
                    >
                      <i class="ri-eye-off-line"></i>
                    </button>
                  </div>
                </div>
              </div>
              <!-- Confirm New Password -->
              <div class="col-12">
                <label class="form-label required">Confirm New Password</label>
                <div class="password-wrapper">
                  <input
                    type="password"
                    class="form-control password-input"
                    id="confirmPassword"
                    placeholder="Password"
                    autocomplete="new-password"
                    required
                  />
                  <button class="password-toggle" type="button" title="Toggle password visibility">
                    <i class="ri-eye-off-line"></i>
                  </button>
                </div>
              </div>
              <div class="col-12 text-end mt-4">
                <button type="submit" class="btn btn-primary">
                  <i class="ri-save-line me-1"></i>Update Password
                </button>
              </div>
            </div>
          </form>
        </div>
      </div>

      <!-- Two-Factor Authentication -->
      <div class="card mt-4">
        <div class="card-header">
          <div class="d-flex align-items-center">
            <i class="ri-shield-star-line me-2"></i>
            <h5 class="card-title mb-0">Two-Factor Authentication (2FA)</h5>
          </div>
        </div>
        <div class="card-body">
          <div class="row g-3">
            <!-- Authenticator App Option -->
            <div class="col-md-6">
              <div class="card h-100">
                <div class="card-body">
                  <div class="d-flex align-items-center mb-3">
                    <i class="ri-smartphone-line me-2 text-primary fs-4"></i>
                    <h5 class="card-title mb-0">Authenticator App</h5>
                  </div>
                  <p class="card-text text-muted">
                    Enhance security with time-based codes from apps like Google Authenticator or
                    Authy.
                  </p>
                  <div class="text-start">
                    <button type="button" class="btn btn-primary">
                      <i class="ri-qr-code-line me-1"></i>Setup Authenticator
                    </button>
                  </div>
                </div>
              </div>
            </div>
            <!-- SMS Authentication Option -->
            <div class="col-md-6">
              <div class="card h-100">
                <div class="card-body">
                  <div class="d-flex align-items-center mb-3">
                    <i class="ri-message-3-line me-2 text-primary fs-4"></i>
                    <h5 class="card-title mb-0">SMS Authentication</h5>
                  </div>
                  <p class="card-text text-muted">
                    Receive secure verification codes via SMS to your registered mobile number.
                  </p>
                  <div class="text-start">
                    <button type="button" class="btn btn-primary">
                      <i class="ri-message-2-line me-1"></i>Setup SMS Verification
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="alert alert-success mt-3 mb-0" role="alert">
            <i class="ri-shield-check-line me-2"></i>
            Your account is protected with two-factor authentication.
          </div>
        </div>
      </div>

      <!-- Login Activity -->
      <div class="card mt-4">
        <div class="card-header">
          <div class="d-flex align-items-center justify-content-between">
            <div class="d-flex align-items-center">
              <i class="ri-history-line me-2"></i>
              <h5 class="card-title mb-0">Recent Login Activity</h5>
            </div>
            <button type="button" class="btn btn-outline-primary btn-sm">
              <i class="ri-download-2-line me-1"></i>Download Log
            </button>
          </div>
        </div>
        <div class="card-body">
          <div class="table-responsive">
            <table class="table table-hover">
              <thead>
                <tr>
                  <th>
                    <i class="ri-calendar-line me-1"></i>Date & Time
                  </th>
                  <th>
                    <i class="ri-global-line me-1"></i>IP Address
                  </th>
                  <th>
                    <i class="ri-computer-line me-1"></i>Device & Browser
                  </th>
                  <th>
                    <i class="ri-map-pin-line me-1"></i>Location
                  </th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>2024-02-20 10:30 AM</td>
                  <td>192.168.1.1</td>
                  <td>
                    <i class="ri-chrome-line me-1"></i>Chrome on Windows
                  </td>
                  <td>
                    <i class="ri-map-pin-2-line me-1"></i>New York, USA
                  </td>
                </tr>
                <tr>
                  <td>2024-02-19 08:15 PM</td>
                  <td>192.168.1.2</td>
                  <td>
                    <i class="ri-safari-line me-1"></i>Safari on iPhone
                  </td>
                  <td>
                    <i class="ri-map-pin-2-line me-1"></i>London, UK
                  </td>
                </tr>
                <tr>
                  <td>2024-02-19 03:45 PM</td>
                  <td>192.168.1.3</td>
                  <td>
                    <i class="ri-firefox-line me-1"></i>Firefox on Mac
                  </td>
                  <td>
                    <i class="ri-question-line me-1"></i>Unknown
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>
</AdminLayout>
